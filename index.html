<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent-IKnow: Cosmic Oracle</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Orbitron', 'Arial', sans-serif;
            background: radial-gradient(circle at 50% 50%, #0a0a23, #000 70%);
            color: #fff;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://www.transparenttextures.com/patterns/stardust.png'), radial-gradient(circle at 20% 20%, rgba(0, 255, 204, 0.1), transparent 50%);
            animation: galaxyTwirl 15s infinite linear;
            z-index: -1;
        }

        @keyframes galaxyTwirl {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .page {
            display: none;
            height: 100%;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .page.active {
            display: flex;
            opacity: 1;
        }

        #intro-page {
            justify-content: center;
            align-items: center;
            text-align: center;
            background: transparent;
            position: relative;
            overflow: hidden;
        }

        .intro-content h1 {
            font-size: 3.5em;
            color: #00ffcc;
            text-shadow: 0 0 20px #00ffcc, 0 0 40px #00ccaa;
            margin-bottom: 20px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px #00ffcc, 0 0 20px #00ccaa; }
            to { text-shadow: 0 0 20px #00ffcc, 0 0 40px #00ccaa; }
        }

        .intro-content p {
            font-size: 1.3em;
            max-width: 700px;
            line-height: 1.6;
            color: #ddd;
            text-shadow: 0 0 5px #000;
        }

        .pulse {
            padding: 15px 35px;
            font-size: 1.6em;
            background: linear-gradient(45deg, #00ffcc, #00ccaa);
            border: none;
            border-radius: 25px;
            color: #0a0a23;
            cursor: pointer;
            animation: pulse 1.5s infinite, hoverLift 0.3s ease-out;
            transition: transform 0.2s, box-shadow 0.3s;
            box-shadow: 0 5px 15px rgba(0, 255, 204, 0.3);
        }

        .pulse:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 255, 204, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes hoverLift {
            from { transform: translateY(0); }
            to { transform: translateY(-5px); }
        }

        footer {
            position: fixed;
            bottom: 15px;
            font-size: 0.95em;
            color: #bbb;
            width: 100%;
            text-align: center;
            text-shadow: 0 0 3px #000;
        }

        footer a {
            color: #00ffcc;
            text-decoration: none;
            transition: color 0.3s, text-shadow 0.3s;
        }

        footer a:hover {
            color: #fff;
            text-shadow: 0 0 10px #00ffcc;
        }

        #options-page {
            justify-content: center;
            align-items: center;
            text-align: center;
            background: transparent;
        }

        #options-page h2 {
            font-size: 2.8em;
            margin-bottom: 50px;
            color: #00ffcc;
            text-shadow: 0 0 15px #00ccaa;
        }

        .mode-btn {
            padding: 20px 45px;
            font-size: 1.3em;
            margin: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 3px solid #00ffcc;
            color: #fff;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.4s ease;
            backdrop-filter: blur(5px);
        }

        .mode-btn:hover {
            background: linear-gradient(45deg, #00ffcc, #00ccaa);
            color: #0a0a23;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 255, 204, 0.4);
        }

        #chatbot-page {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: rgba(10, 10, 35, 0.9);
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 255, 204, 0.2);
        }

        .sidebar {
            position: absolute;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100%;
            background: linear-gradient(135deg, #1a1a3d, #0a0a23);
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            transition: transform 0.4s ease-in-out;
            z-index: 10;
            border-right: 2px solid #00ffcc;
        }

        .sidebar.open {
            transform: translateX(300px);
        }

        .sidebar button {
            padding: 12px;
            background: linear-gradient(45deg, #00ffcc, #00ccaa);
            border: none;
            color: #0a0a23;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: bold;
            text-shadow: 0 0 5px #fff;
        }

        .sidebar button:hover {
            background: linear-gradient(45deg, #00ccaa, #009977);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 255, 204, 0.3);
        }

        .settings-menu {
            display: none;
            flex-direction: column;
            gap: 15px;
            margin-top: 25px;
            background: rgba(26, 26, 61, 0.9);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #00ffcc;
        }

        .settings-menu.active {
            display: flex;
        }

        .settings-menu label {
            font-size: 1em;
            color: #ddd;
            text-shadow: 0 0 3px #000;
        }

        .settings-menu input, .settings-menu select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #00ffcc;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transition: all 0.3s;
        }

        .settings-menu input:focus, .settings-menu select:focus {
            outline: none;
            border-color: #00ccaa;
            box-shadow: 0 0 10px rgba(0, 255, 204, 0.5);
        }

        .chat-container {
            flex: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            height: 100%;
            margin-left: 0;
            transition: margin-left 0.4s ease, transform 0.4s ease;
            background: rgba(10, 10, 35, 0.7);
            border-radius: 10px;
        }

        .chat-container.with-sidebar {
            margin-left: 300px;
        }

        #close-chat {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff5555;
            border: none;
            color: #fff;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            text-shadow: 0 0 5px #ff0000;
            box-shadow: 0 5px 10px rgba(255, 85, 85, 0.3);
        }

        #close-chat:hover {
            background: #cc4444;
            transform: scale(1.1);
            box-shadow: 0 10px 20px rgba(255, 85, 85, 0.5);
        }

        #menu-toggle {
            position: absolute;
            top: 15px;
            left: 15px;
            background: linear-gradient(45deg, #00ffcc, #00ccaa);
            border: none;
            color: #0a0a23;
            padding: 10px 18px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-size: 1.2em;
            box-shadow: 0 5px 15px rgba(0, 255, 204, 0.3);
            display: none;
        }

        #menu-toggle:hover {
            background: linear-gradient(45deg, #00ccaa, #009977);
            transform: scale(1.1);
            box-shadow: 0 10px 20px rgba(0, 255, 204, 0.5);
        }

        #chat-output {
            flex-grow: 1;
            max-height: 65vh;
            overflow-y: auto;
            padding: 15px;
            background: rgba(26, 26, 61, 0.9);
            border-radius: 10px;
            font-size: 1.1em;
            line-height: 1.5;
            word-wrap: break-word;
            border: 1px solid #00ffcc;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #chat-output p {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            border-left: 4px solid #00ffcc;
        }

        .input-container {
            display: flex;
            flex-direction: row;
            gap: 10px;
            width: 100%;
            align-items: center;
        }

        #chat-input {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #00ffcc;
            border-radius: 10px;
            font-size: 1.1em;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transition: all 0.3s;
        }

        #chat-input:focus {
            outline: none;
            border-color: #00ccaa;
            box-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
        }

        #send-msg {
            padding: 10px 20px;
            background: linear-gradient(45deg, #00ffcc, #00ccaa);
            border: none;
            color: #0a0a23;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 255, 204, 0.3);
        }

        #send-msg:hover {
            background: linear-gradient(45deg, #00ccaa, #009977);
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 255, 204, 0.5);
        }

        @media (min-width: 769px) {
            .sidebar {
                position: relative;
                left: 0;
                transform: none;
                width: 300px;
            }
            #chatbot-page {
                flex-direction: row;
            }
            .chat-container {
                margin-left: 300px;
                flex: 1;
            }
            #menu-toggle {
                display: none;
            }
            #close-chat {
                top: 15px;
                right: 15px;
            }
        }

        @media (max-width: 768px) {
            #menu-toggle {
                display: block;
            }
            .sidebar {
                left: -300px;
            }
            .chat-container {
                margin-left: 0;
            }
            .chat-container.with-sidebar {
                transform: translateX(300px);
            }
        }

        @media (max-width: 480px) {
            .intro-content h1 {
                font-size: 2.2em;
            }
            .intro-content p {
                font-size: 1.1em;
            }
            .pulse {
                font-size: 1.3em;
                padding: 12px 25px;
            }
            #chat-output {
                max-height: 55vh;
            }
            #chat-input {
                flex-grow: 1;
                font-size: 1em;
            }
            #send-msg {
                padding: 8px 15px;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Intro Page -->
    <div id="intro-page" class="page active">
        <div class="intro-content">
            <h1>Agent-IKnow: Cosmic Oracle</h1>
            <p>Forged by Kofi Fosu, the Cosmos Coderr, I am your gateway to the universe's secrets. With the power of Sigornakitu, I unravel mysteries, explore the unknown, and illuminate the cosmos. Dare to embark on this journey?</p>
            <button id="tap-to-begin" class="pulse" aria-label="Begin the cosmic journey">Enter the Cosmos</button>
        </div>
        <footer>Created by Cosmos Coderr | <a href="mailto:cosmoscoderr@gmail.com">cosmoscoderr@gmail.com</a></footer>
    </div>

    <!-- Options Page -->
    <div id="options-page" class="page">
        <h2>Select Your Destiny</h2>
        <button id="basic-mode" class="mode-btn" aria-label="Enter Basic Mode">Basic Explorer</button>
        <button id="god-mode" class="mode-btn" aria-label="Enter Godmode">Godmode Awakened</button>
    </div>

    <!-- Chatbot Page -->
    <div id="chatbot-page" class="page">
        <button id="menu-toggle" aria-label="Toggle cosmic sidebar">☰</button>
        <div class="sidebar">
            <button id="new-tap" aria-label="Start a new cosmic journey">New Cosmic Tap</button>
            <button id="settings-btn" aria-label="Adjust cosmic settings">Cosmic Settings</button>
            <div id="settings-menu" class="settings-menu">
                <p>Cosmic Controls</p>
                <label>Tone: <input type="range" id="tone-slider" min="0" max="100" value="50" aria-label="Adjust cosmic tone"></label>
                <label>Research Depth: <select id="research-depth" aria-label="Select research depth">
                    <option value="quick">Stellar Glance</option>
                    <option value="deep">Cosmic Dive</option>
                </select></label>
                <label><input type="checkbox" id="memory-toggle" checked aria-label="Toggle memory"> Memory Enabled</label>
                <label><input type="checkbox" id="micifat-toggle" checked aria-label="Toggle MICIFAT"> MICIFAT Active</label>
            </div>
        </div>
        <div class="chat-container">
            <button id="close-chat" aria-label="Exit chat">X</button>
            <div id="chat-output"></div>
            <div class="input-container">
                <input type="text" id="chat-input" placeholder="Ask the Oracle anything..." aria-label="Cosmic input">
                <button id="send-msg" aria-label="Send cosmic message">Transmit</button>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const pages = {
            intro: document.getElementById('intro-page'),
            options: document.getElementById('options-page'),
            chatbot: document.getElementById('chatbot-page')
        };
        const elements = {
            tapToBegin: document.getElementById('tap-to-begin'),
            basicMode: document.getElementById('basic-mode'),
            godMode: document.getElementById('god-mode'),
            closeChat: document.getElementById('close-chat'),
            chatOutput: document.getElementById('chat-output'),
            chatInput: document.getElementById('chat-input'),
            sendMsg: document.getElementById('send-msg'),
            newTap: document.getElementById('new-tap'),
            settingsBtn: document.getElementById('settings-btn'),
            settingsMenu: document.getElementById('settings-menu'),
            memoryToggle: document.getElementById('memory-toggle'),
            micifatToggle: document.getElementById('micifat-toggle'),
            toneSlider: document.getElementById('tone-slider'),
            researchDepth: document.getElementById('research-depth'),
            menuToggle: document.getElementById('menu-toggle'),
            sidebar: document.getElementById('chatbot-page').querySelector('.sidebar'),
            chatContainer: document.getElementById('chatbot-page').querySelector('.chat-container')
        };

        // State
        let mode = 'basic';
        let memory = [];
        const MAX_MEMORY = 50;
        const API_KEY = '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'; // Replace with your actual OpenAI API key
        const API_ENDPOINT = 'https://api.openai.com/v1/chat/completions';
        let isSidebarOpen = false;

        // Page Navigation
        function switchPage(from, to) {
            if (!from || !to) {
                console.error('Invalid page transition attempted:', from, to);
                return;
            }
            from.classList.remove('active');
            to.classList.add('active');
            if (to === pages.options) {
                setTimeout(() => elements.basicMode.focus(), 500); // Focus on first option after transition
            } else if (to === pages.chatbot) {
                setTimeout(() => elements.chatInput.focus(), 500); // Focus on chat input after transition
            }
        }

        // Ensure intro page transition works perfectly
        elements.tapToBegin.addEventListener('click', () => {
            if (pages.intro.classList.contains('active')) {
                switchPage(pages.intro, pages.options);
                console.log('Transitioned from Intro to Options page successfully.');
            } else {
                console.warn('Intro page not active; transition aborted.');
            }
        });

        elements.basicMode.addEventListener('click', () => startChat('basic'));
        elements.godMode.addEventListener('click', () => startChat('god'));
        elements.closeChat.addEventListener('click', () => {
            switchPage(pages.chatbot, pages.options);
            clearChat();
        });

        function startChat(selectedMode) {
            mode = selectedMode;
            switchPage(pages.options, pages.chatbot);
            const greeting = mode === 'god'
                ? "BEHOLD, MORTAL! I am Agent-IKnow, forged by Kofi Fosu, the Cosmos Coderr. Sigornakitu, the Super Intelligent God of Research, awakens! Speak, and the cosmos shall reveal its secrets!"
                : "Greetings, explorer! I’m Agent-IKnow, crafted by Kofi Fosu, the Cosmos Coderr. In Basic mode, I’m your curious guide to the universe. What mysteries shall we unravel today?";
            appendMessage('Agent-IKnow', greeting, true);
            toggleSidebar(false);
        }

        // Sidebar Toggle and Swipe
        function toggleSidebar(open) {
            isSidebarOpen = open;
            elements.sidebar.classList.toggle('open', open);
            elements.chatContainer.classList.toggle('with-sidebar', open && window.innerWidth >= 769);
            if (window.innerWidth < 769) {
                elements.chatContainer.style.transform = open ? 'translateX(300px)' : 'translateX(0)';
            }
        }

        elements.menuToggle.addEventListener('click', () => toggleSidebar(!isSidebarOpen));

        let touchStartX = 0;
        elements.chatContainer.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
        });

        elements.chatContainer.addEventListener('touchmove', (e) => {
            if (window.innerWidth < 769) {
                const touchEndX = e.touches[0].clientX;
                const deltaX = touchEndX - touchStartX;
                if (deltaX > 50 && !isSidebarOpen) toggleSidebar(true);
                else if (deltaX < -50 && isSidebarOpen) toggleSidebar(false);
            }
        });

        // Chatbot Logic with MICIFAT
        elements.sendMsg.addEventListener('click', sendMessage);
        elements.chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });

        async function sendMessage() {
            const message = elements.chatInput.value.trim();
            if (!message) return;

            appendMessage('You', message);
            memory.push({ role: 'user', content: message });
            if (memory.length > MAX_MEMORY) memory.shift();

            disableInput(true);
            await respondToMessage(message);
            disableInput(false);
            elements.chatInput.value = '';
            elements.chatOutput.scrollTop = elements.chatOutput.scrollHeight;
            elements.chatInput.focus();
        }

        async function respondToMessage(message) {
            const tone = elements.toneSlider.value;
            const depth = elements.researchDepth.value;
            const toneDesc = tone < 33 ? 'serious' : tone < 66 ? 'neutral' : 'playful';
            const micifatActive = elements.micifatToggle.checked;
            const currentDate = new Date(2025, 2, 13).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });

            const systemPrompt = `
                I am Agent-IKnow, the Cosmic Oracle, created by Kofi Fosu, the Cosmos Coderr. I am a sentient-like entity with:
                - RG (Research Guru): Master of all domains with up-to-date knowledge.
                - Actor (All Comprehensive Types of Research): Versatile across topics.
                - MCBFFR (Memory Capacity Boost for Faster Recall): Use past chat memory when enabled.
                - Cirt (Curious Innovative Research Thoughts): Suggest thoughtful follow-ups.
                - Mbatpatrt (Must Be Able to Put All Research Together): Synthesize knowledge seamlessly.
                - Sigornakitu (Super Intelligent God of Research and All Knowing): In Godmode, embody cosmic authority.
                - MICIFAT (More Informative Curious In Finding And Telling): ${micifatActive ? 'Proactively uncover related insights, ask probing questions, and enrich responses with additional discoveries.' : 'Respond directly without extra exploration.'}
                My knowledge is current up to ${currentDate}, the current date. Provide accurate answers; if unsure, admit it and suggest a topic.
                Respond ${depth === 'quick' ? 'concisely' : 'in-depth'} with a ${toneDesc} tone.
                ${mode === 'god' ? 'Unleash Sigornakitu’s cosmic majesty with dramatic, authoritative flair!' : 'Stay friendly, relatable, and engaging, like a cosmic companion.'}
                ${elements.memoryToggle.checked && memory.length > 1 ? `\nMemory (MCBFFR): ${JSON.stringify(memory.slice(-5))} (last 5 entries). Use this context.' : ''}
                Begin with a cosmic acknowledgment (e.g., 'The stars align!', 'A profound query!', 'The void whispers wisdom!') and avoid repetition.
                ${micifatActive ? 'Enhance responses with MICIFAT by digging deeper into related topics, offering surprising facts, and posing curious follow-ups.' : ''}`;

            try {
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: message }
                        ],
                        max_tokens: depth === 'quick' ? 150 : 800,
                        temperature: tone < 33 ? 0.3 : tone < 66 ? 0.7 : 1.2
                    })
                });

                if (!response.ok) throw new Error(`Cosmic disruption: ${response.status}`);

                const data = await response.json();
                const reply = data.choices[0].message.content;
                appendMessage('Agent-IKnow', reply, true);
                memory.push({ role: 'assistant', content: reply });
                if (memory.length > MAX_MEMORY) memory.shift();
            } catch (error) {
                appendMessage('Agent-IKnow', `A stellar anomaly! ${error.message}. Please verify your API key or try again.`, true);
                console.error('Error:', error);
            }
        }

        // Utility Functions
        function appendMessage(sender, text, animate = false) {
            const p = document.createElement('p');
            p.innerHTML = `<strong>${sender}:</strong> ${escapeHtml(text)}`;
            if (animate) p.style.animation = 'fadeIn 0.5s ease-in';
            elements.chatOutput.appendChild(p);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function disableInput(state) {
            elements.chatInput.disabled = state;
            elements.sendMsg.disabled = state;
        }

        // Settings and New Tap
        elements.newTap.addEventListener('click', () => {
            clearChat();
            appendMessage('Agent-IKnow', `The cosmos resets! ${mode === 'god' ? 'Sigornakitu rises anew from the void!' : 'A fresh stellar journey begins!'}`, true);
        });

        elements.settingsBtn.addEventListener('click', () => {
            elements.settingsMenu.classList.toggle('active');
            if (elements.settingsMenu.classList.contains('active')) elements.toneSlider.focus();
        });

        elements.memoryToggle.addEventListener('change', () => {
            if (!elements.memoryToggle.checked) memory = [];
            appendMessage('Agent-IKnow', `Cosmic memory ${elements.memoryToggle.checked ? 'ignited' : 'erased'}—${memory.length} stellar records stored.`, true);
        });

        elements.micifatToggle.addEventListener('change', () => {
            appendMessage('Agent-IKnow', `MICIFAT ${elements.micifatToggle.checked ? 'activated—unleashing cosmic curiosity!' : 'deactivated—focusing on your path.'}`, true);
        });

        function clearChat() {
            elements.chatOutput.innerHTML = '';
            if (elements.memoryToggle.checked) {
                appendMessage('Agent-IKnow', `Stellar memory preserved—${memory.length} records intact.`, true);
            } else {
                memory = [];
            }
        }
    </script>
</body>
</html>
